{"ast":null,"code":"/* \nWhats the purpose of this function?\nInitially the audio files were streamed from the backend to the frontend using a URL aka blobUrl.\nHowever, with the introduction of the authorization thingy this was not possible anymore (without \n    a serious security breach eg adding the authorization token as part of the blobUrl).\nAs an alternative solution to using the html5 audio component, the following function uses the \nWeb Audio Api. Code taken from: \nhttps://stackoverflow.com/questions/48277432/load-html5-audio-from-dynamic-content-provider-with-authentication\n\nResources:\nhttps://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\n*/\nexport default function streamAudioWithAuth(blobURL, authToken) {\n  console.log(\"Attempting to stream from\");\n  console.log(blobURL); // create context\n\n  let audioCtx = new (window.AudioContext || window.webkitAudioContext)(); // create source\n\n  let source = audioCtx.createBufferSource(); // route source\n\n  source.connect(audioCtx.destination); // prepare request\n\n  let request = new XMLHttpRequest();\n  request.open('GET', blobURL, true\n  /* async */\n  );\n  request.responseType = 'arraybuffer';\n\n  request.onload = function () {\n    // on load callback\n    // get audio data\n    let audioData = request.response; // try to decode audio data\n\n    audioCtx.decodeAudioData(audioData, function (buffer) {\n      // on success callback\n      console.log(\"Successfully decoded\"); // set source\n\n      source.buffer = buffer; // .. do whatever you want with the source\n      // e.g. play it\n\n      source.start(0); // or stop\n      // source.stop();\n    }, function (e) {\n      // on error callback\n      console.log(\"An error occurred\");\n      console.log(e);\n    });\n  };\n\n  request.setRequestHeader(\"Authorization\", `Bearer ${authToken}`);\n  request.send();\n}","map":{"version":3,"names":["streamAudioWithAuth","blobURL","authToken","console","log","audioCtx","window","AudioContext","webkitAudioContext","source","createBufferSource","connect","destination","request","XMLHttpRequest","open","responseType","onload","audioData","response","decodeAudioData","buffer","start","e","setRequestHeader","send"],"sources":["/Users/sema/UNote/client/src/components/helpers/audioStreamWithAuth.js"],"sourcesContent":["/* \nWhats the purpose of this function?\nInitially the audio files were streamed from the backend to the frontend using a URL aka blobUrl.\nHowever, with the introduction of the authorization thingy this was not possible anymore (without \n    a serious security breach eg adding the authorization token as part of the blobUrl).\nAs an alternative solution to using the html5 audio component, the following function uses the \nWeb Audio Api. Code taken from: \nhttps://stackoverflow.com/questions/48277432/load-html5-audio-from-dynamic-content-provider-with-authentication\n\nResources:\nhttps://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\n*/\nexport default function streamAudioWithAuth(blobURL, authToken) {\n\n    console.log(\"Attempting to stream from\");\n    console.log(blobURL);\n\n    // create context\n    let audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n\n    // create source\n    let source = audioCtx.createBufferSource();\n\n    // route source\n    source.connect(audioCtx.destination);\n\n    // prepare request\n    let request = new XMLHttpRequest();\n    request.open('GET', blobURL, true /* async */);\n    request.responseType = 'arraybuffer';\n\n    request.onload = function () {\n        // on load callback\n\n        // get audio data\n        let audioData = request.response;\n\n        // try to decode audio data\n        audioCtx.decodeAudioData(audioData,\n            function (buffer) {\n                // on success callback\n                console.log(\"Successfully decoded\");\n\n                // set source\n                source.buffer = buffer;\n\n                // .. do whatever you want with the source\n                // e.g. play it\n                source.start(0);\n                // or stop\n                // source.stop();\n            },\n            function (e) {\n                // on error callback\n                console.log(\"An error occurred\");\n                console.log(e);\n            });\n    };\n    request.setRequestHeader(\"Authorization\", `Bearer ${authToken}`);\n    request.send();\n}\n\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASA,mBAAT,CAA6BC,OAA7B,EAAsCC,SAAtC,EAAiD;EAE5DC,OAAO,CAACC,GAAR,CAAY,2BAAZ;EACAD,OAAO,CAACC,GAAR,CAAYH,OAAZ,EAH4D,CAK5D;;EACA,IAAII,QAAQ,GAAG,KAAKC,MAAM,CAACC,YAAP,IAAuBD,MAAM,CAACE,kBAAnC,GAAf,CAN4D,CAQ5D;;EACA,IAAIC,MAAM,GAAGJ,QAAQ,CAACK,kBAAT,EAAb,CAT4D,CAW5D;;EACAD,MAAM,CAACE,OAAP,CAAeN,QAAQ,CAACO,WAAxB,EAZ4D,CAc5D;;EACA,IAAIC,OAAO,GAAG,IAAIC,cAAJ,EAAd;EACAD,OAAO,CAACE,IAAR,CAAa,KAAb,EAAoBd,OAApB,EAA6B;EAAK;EAAlC;EACAY,OAAO,CAACG,YAAR,GAAuB,aAAvB;;EAEAH,OAAO,CAACI,MAAR,GAAiB,YAAY;IACzB;IAEA;IACA,IAAIC,SAAS,GAAGL,OAAO,CAACM,QAAxB,CAJyB,CAMzB;;IACAd,QAAQ,CAACe,eAAT,CAAyBF,SAAzB,EACI,UAAUG,MAAV,EAAkB;MACd;MACAlB,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAFc,CAId;;MACAK,MAAM,CAACY,MAAP,GAAgBA,MAAhB,CALc,CAOd;MACA;;MACAZ,MAAM,CAACa,KAAP,CAAa,CAAb,EATc,CAUd;MACA;IACH,CAbL,EAcI,UAAUC,CAAV,EAAa;MACT;MACApB,OAAO,CAACC,GAAR,CAAY,mBAAZ;MACAD,OAAO,CAACC,GAAR,CAAYmB,CAAZ;IACH,CAlBL;EAmBH,CA1BD;;EA2BAV,OAAO,CAACW,gBAAR,CAAyB,eAAzB,EAA2C,UAAStB,SAAU,EAA9D;EACAW,OAAO,CAACY,IAAR;AACH"},"metadata":{},"sourceType":"module"}