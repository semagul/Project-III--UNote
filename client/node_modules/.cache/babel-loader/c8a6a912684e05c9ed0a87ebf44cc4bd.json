{"ast":null,"code":"import _slicedToArray from\"/Users/sema/tagtag/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/React.createContext();function AuthProviderWrapper(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoggedIn=_useState4[0],setIsLoggedIn=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];// const loginUser = token => {\n//     // store this in local stoga provided by the browser\n//     // window is the top level execution method of console.log. window.console.log\n//     // window.localStorage.setItem('authToken', token)\n//     localStorage.setItem('authToken', token)\n//     verifyStoredToken()\n// }\nvar storeToken=function storeToken(token){// store this token in local storage\nlocalStorage.setItem(\"authToken\",token);};var logoutUser=function logoutUser(){// remove the token from local storage\nlocalStorage.removeItem('authToken');// update the state\nsetIsLoggedIn(false);setUser(null);};var verifyStoredToken=function verifyStoredToken(){var storedToken=localStorage.getItem('authToken');if(storedToken){return axios.get('/api/auth/verify',{headers:{Authorization:\"Bearer \".concat(storedToken)}}).then(function(response){var user=response.data;setUser(user);setIsLoggedIn(true);setIsLoading(false);}).catch(function(err){// invalid token\nsetIsLoggedIn(false);setUser(null);setIsLoading(false);});}else{setIsLoading(false);}};useEffect(function(){// check if we have an auth token store\nverifyStoredToken();},[]);return/*#__PURE__*/ (// it covers whatever the component is wrapped around the above tags\n_jsx(AuthContext.Provider,{value:{isLoggedIn:isLoggedIn,storeToken:storeToken,user:user,isLoading:isLoading,verifyStoredToken:verifyStoredToken,logoutUser:logoutUser},children:props.children}));}export{AuthProviderWrapper,AuthContext};","map":{"version":3,"names":["React","useState","useEffect","axios","AuthContext","createContext","AuthProviderWrapper","props","user","setUser","isLoggedIn","setIsLoggedIn","isLoading","setIsLoading","storeToken","token","localStorage","setItem","logoutUser","removeItem","verifyStoredToken","storedToken","getItem","get","headers","Authorization","then","response","data","catch","err","children"],"sources":["/Users/sema/tagtag/client/src/context/auth.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\n\nconst AuthContext = React.createContext()\n\nfunction AuthProviderWrapper(props) {\n    const [user, setUser] = useState(null)\n    const [isLoggedIn, setIsLoggedIn] = useState(false)\n    const [isLoading, setIsLoading] = useState(true)\n\n    // const loginUser = token => {\n    //     // store this in local stoga provided by the browser\n    //     // window is the top level execution method of console.log. window.console.log\n    //     // window.localStorage.setItem('authToken', token)\n    //     localStorage.setItem('authToken', token)\n    //     verifyStoredToken()\n\n    // }\n\n    const storeToken = (token) => {\n        // store this token in local storage\n        localStorage.setItem(\"authToken\", token);\n    };\n\n    const logoutUser = () => {\n        // remove the token from local storage\n        localStorage.removeItem('authToken')\n        // update the state\n        setIsLoggedIn(false)\n        setUser(null)\n    }\n\n    const verifyStoredToken = () => {\n        const storedToken = localStorage.getItem('authToken')\n        if (storedToken) {\n            return axios\n                .get('/api/auth/verify', { headers: { Authorization: `Bearer ${storedToken}` } })\n                .then(response => {\n                    const user = response.data\n                    setUser(user)\n                    setIsLoggedIn(true)\n                    setIsLoading(false)\n                })\n                .catch(err => {\n                    // invalid token\n                    setIsLoggedIn(false)\n                    setUser(null)\n                    setIsLoading(false)\n                })\n        } else {\n            setIsLoading(false)\n        }\n    }\n\n    useEffect(() => {\n        // check if we have an auth token store\n        verifyStoredToken()\n    }, [])\n\n    return (\n        // it covers whatever the component is wrapped around the above tags\n        <AuthContext.Provider value={{\n            isLoggedIn,\n            storeToken,\n            user,\n            isLoading,\n            verifyStoredToken,\n            logoutUser\n        }}\n        >\n            {props.children}\n        </AuthContext.Provider>\n    )\n}\n\nexport { AuthProviderWrapper, AuthContext }"],"mappings":"+GAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,2CAEA,GAAMC,YAAW,cAAGJ,KAAK,CAACK,aAAN,EAApB,CAEA,QAASC,oBAAT,CAA6BC,KAA7B,CAAoC,CAChC,cAAwBN,QAAQ,CAAC,IAAD,CAAhC,wCAAOO,IAAP,eAAaC,OAAb,eACA,eAAoCR,QAAQ,CAAC,KAAD,CAA5C,yCAAOS,UAAP,eAAmBC,aAAnB,eACA,eAAkCV,QAAQ,CAAC,IAAD,CAA1C,yCAAOW,SAAP,eAAkBC,YAAlB,eAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA,GAAMC,WAAU,CAAG,QAAbA,WAAa,CAACC,KAAD,CAAW,CAC1B;AACAC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAkCF,KAAlC,EACH,CAHD,CAKA,GAAMG,WAAU,CAAG,QAAbA,WAAa,EAAM,CACrB;AACAF,YAAY,CAACG,UAAb,CAAwB,WAAxB,EACA;AACAR,aAAa,CAAC,KAAD,CAAb,CACAF,OAAO,CAAC,IAAD,CAAP,CACH,CAND,CAQA,GAAMW,kBAAiB,CAAG,QAApBA,kBAAoB,EAAM,CAC5B,GAAMC,YAAW,CAAGL,YAAY,CAACM,OAAb,CAAqB,WAArB,CAApB,CACA,GAAID,WAAJ,CAAiB,CACb,MAAOlB,MAAK,CACPoB,GADE,CACE,kBADF,CACsB,CAAEC,OAAO,CAAE,CAAEC,aAAa,kBAAYJ,WAAZ,CAAf,CAAX,CADtB,EAEFK,IAFE,CAEG,SAAAC,QAAQ,CAAI,CACd,GAAMnB,KAAI,CAAGmB,QAAQ,CAACC,IAAtB,CACAnB,OAAO,CAACD,IAAD,CAAP,CACAG,aAAa,CAAC,IAAD,CAAb,CACAE,YAAY,CAAC,KAAD,CAAZ,CACH,CAPE,EAQFgB,KARE,CAQI,SAAAC,GAAG,CAAI,CACV;AACAnB,aAAa,CAAC,KAAD,CAAb,CACAF,OAAO,CAAC,IAAD,CAAP,CACAI,YAAY,CAAC,KAAD,CAAZ,CACH,CAbE,CAAP,CAcH,CAfD,IAeO,CACHA,YAAY,CAAC,KAAD,CAAZ,CACH,CACJ,CApBD,CAsBAX,SAAS,CAAC,UAAM,CACZ;AACAkB,iBAAiB,GACpB,CAHQ,CAGN,EAHM,CAAT,CAKA,oBACI;AACA,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CACzBV,UAAU,CAAVA,UADyB,CAEzBI,UAAU,CAAVA,UAFyB,CAGzBN,IAAI,CAAJA,IAHyB,CAIzBI,SAAS,CAATA,SAJyB,CAKzBQ,iBAAiB,CAAjBA,iBALyB,CAMzBF,UAAU,CAAVA,UANyB,CAA7B,UASKX,KAAK,CAACwB,QATX,EAFJ,EAcH,CAED,OAASzB,mBAAT,CAA8BF,WAA9B"},"metadata":{},"sourceType":"module"}